<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="version" content="1758926533647">
<title>Hexo NexT 博客主题美化 - 回到森林吧</title>
<link rel="stylesheet" href="/css/style.css?v=1758926533647">

<!-- 网站图标 -->
<link rel="shortcut icon" href="/images/favicon.ico?v=1758926533647" type="image/x-icon">
<link rel="icon" href="/images/favicon.ico?v=1758926533647" type="image/x-icon">

<!-- 引用 highlight.js -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/vs.min.css">
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/languages/javascript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/languages/css.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/languages/scss.min.js"></script>


<!-- fancybox CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />

<!-- jQuery and fancybox JS -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<!-- mermaid JS -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@7.1.2/dist/mermaid.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  mermaid.initialize({
    startOnLoad: true,
    theme: 'default',
    flowchart: {
      useMaxWidth: true,
      htmlLabels: true
    }
  });
  
  // 处理 Markdown 代码块
  const codeBlocks = document.querySelectorAll('pre code');
  codeBlocks.forEach(function(block) {
    const className = block.className;
    if (className.includes('language-mermaid') || className.includes('mermaid')) {
      const code = block.textContent;
      const mermaidDiv = document.createElement('div');
      mermaidDiv.className = 'mermaid';
      mermaidDiv.textContent = code;
      block.parentNode.parentNode.replaceChild(mermaidDiv, block.parentNode);
    }
  });
});
</script>
    
    <!-- 预连接和预加载优化 -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="//music.163.com">
    <link rel="dns-prefetch" href="//api.i-meto.com">
    
    <!-- 预加载关键资源 -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" as="style">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js" as="script">
    
    <!-- 引入 highlight.js 样式 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="回到森林吧" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="headerArea">
        <div id="header">
            <h1 class="site-title">回到森林吧</h1>
        </div>
        <nav id="navbar">
  <ul>
    <li><a href="/">首页</a></li>
    <li><a href="/archives/">归档</a></li>
    <li><a href="/articles/">文章</a></li>
    <li><a href="/atom.xml">订阅</a></li> 
  </ul>
</nav>
    </div>

    <div id="pjax-container">
        <div id="flex">
            <main>
    <h1>Hexo NexT 博客主题美化</h1>
    <!-- 添加文章元信息 -->
    <div class="post-meta">
        <span class="meta-date">
            <span class="meta-label">日期：</span>
            2024-07-16
        </span>
        <span class="separator">|</span>
        <span class="meta-categories">
            <span class="meta-label">分类：</span>
            
                
                    <a href="/categories/%E6%95%99%E7%A8%8B/" class="y2k-link">教程</a>
                    
                
            
        </span>
        <span class="separator">|</span>
        <span class="meta-tags">
            <span class="meta-label">标签：</span>
            
                
                    <a href="/tags/hexo/" class="y2k-link">hexo</a>
                    
                
            
        </span>
    </div>
    <div class="post-content">
        <p>给Hexo博客换了nexT主题，由于8.0版本的部分美化教程在网上很难找到，所以直接自己动手拆文件改完了。  </p>
<p>非技术党，代码全部由chatgpt生成，主题风格是Pisces，感兴趣的可以试一下。</p>
<span id="more"></span>
<div class="toc">

<!-- toc -->

<ul>
<li><a href="#%E4%BF%AE%E6%94%B9%E5%A4%B4%E9%83%A8%E6%A0%87%E9%A2%98%E6%A0%8F%E8%83%8C%E6%99%AF%E8%89%B2">修改头部标题栏背景色</a></li>
<li><a href="#%E5%9C%A8%E5%A4%B4%E9%83%A8%E6%A0%87%E9%A2%98%E6%A0%8F%E6%B7%BB%E5%8A%A0%E6%96%87%E5%AD%97">在头部标题栏添加文字</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AE%E5%8D%9A%E5%AE%A2%E8%83%8C%E6%99%AF%E5%9B%BE%E7%89%87">设置博客背景图片</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E4%BE%A7%E8%BE%B9%E6%A0%8F%E5%BC%BA%E8%B0%83%E8%89%B2">修改侧边栏强调色</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E8%B6%85%E9%93%BE%E6%8E%A5%E9%A2%9C%E8%89%B2">修改超链接颜色</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E5%8D%9A%E5%AE%A2%E5%AD%97%E4%BD%93%E6%A0%B7%E5%BC%8F">修改博客字体样式</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E6%96%87%E7%AB%A0%E6%A0%87%E9%A2%98%E6%A0%B7%E5%BC%8F">修改文章标题样式</a></li>
<li><a href="#%E7%BB%99%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0-top-%E6%96%87%E7%AB%A0%E7%BD%AE%E9%A1%B6">给博客添加 top 文章置顶</a></li>
</ul>
<!-- tocstop -->

</div>
## 修改头部标题栏背景色
打开 `博客根目录\themes\next\source\css\_variables\base.styl` 文件，查找 `theme-color` 并找到以下内容修改对应颜色码。  

<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-comment">//原theme-color  = convert(hexo-config(&#x27;theme_color.light&#x27;));</span><br><span class="hljs-variable">$theme-color</span>                  = 对应颜色码;<br><span class="hljs-variable">$theme-color-dark</span>             = <span class="hljs-built_in">convert</span>(hexo-config(&#x27;theme_color.dark&#x27;));<br></code></pre></td></tr></table></figure>

<p><code>$theme-color-dark</code> 为夜间模式，也可以修改。</p>
<h2><span id="在头部标题栏添加文字">在头部标题栏添加文字</span></h2><p>打开 <code>博客根目录\themes\next\layout\_partials\header\brand.njk</code> 文件，查找 <code>site-subtitle</code> 并修改以下代码。  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;site-subtitle&quot;</span> <span class="hljs-attr">itemprop</span>=<span class="hljs-string">&quot;description&quot;</span>&gt;</span>文字内容<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2><span id="设置博客背景图片">设置博客背景图片</span></h2><p>打开 <code>博客根目录\themes\next\source\css\_schemes\Pisces\index.styl</code> 文件，查找 <code>.main-inner &#123;</code> 并在<strong>上方</strong>添加以下代码。  </p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-selector-tag">body</span> &#123;<br>  <span class="hljs-attribute">background</span>:<span class="hljs-built_in">url</span>(背景图片url);<br>  <span class="hljs-attribute">background-attachment</span>: fixed;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>url地址可以直接填网图，也可以将图片放在 <code>博客根目录\themes\next\source\images</code> 文件夹内并填入对应路径。</p>
<h2><span id="修改侧边栏强调色">修改侧边栏强调色</span></h2><p><em>针对点进文章后，对鼠标点击&#x2F;悬浮在<strong>文章目录</strong>和<strong>站点概括</strong>时的强调色进行修改。</em>  </p>
<p>打开 <code>博客根目录\themes\next\source\css\_variables\Pisces.styl</code> 文件，查找 <code>$sidebar-nav-color</code> ，修改以下内容。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-comment">// Sidebar</span><br><span class="hljs-comment">// --------------------------------------------------</span><br><span class="hljs-variable">$sidebar-nav-color</span>                = <span class="hljs-selector-tag">var</span>(--text-color);<br><span class="hljs-variable">$sidebar-nav-hover-color</span>          = 对应颜色码;<br><span class="hljs-variable">$sidebar-highlight</span>                = 对应颜色码;<br></code></pre></td></tr></table></figure>

<p><code>$sidebar-nav-hover-color</code> 为鼠标悬浮时的强调色。<br><code>$sidebar-highlight</code> 为鼠标点击时的强调色。</p>
<h2><span id="修改超链接颜色">修改超链接颜色</span></h2><p>打开 <code>博客根目录\themes\next\source\css\_common\components\post\index.styl</code> 文件，在最下方添加以下代码。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-selector-class">.post-body</span> <span class="hljs-selector-tag">p</span> <span class="hljs-selector-tag">a</span>&#123;<br> <span class="hljs-attribute">color</span>: 对应颜色码;<br> <span class="hljs-attribute">border-bottom</span>: none;<br> &amp;<span class="hljs-selector-pseudo">:hover</span> &#123;<br>   <span class="hljs-attribute">color</span>: 对应颜色码;<br>   <span class="hljs-selector-tag">text</span>-decoration: underline;<br> &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p><code>.post-body p a&#123;</code> 为超链接正常显示的颜色。<br><code> &amp;:hover &#123;</code> 为鼠标悬浮在超链接时的颜色。</p>
<h2><span id="修改博客字体样式">修改博客字体样式</span></h2><p>打开 <code>博客根目录\themes\next\_config.yml</code> 文件，针对以下内容进行修改。<br>以本博客为例。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">font:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br><br>  <span class="hljs-comment"># Uri of fonts host, e.g. https://fonts.googleapis.com (Default).</span><br>  <span class="hljs-attr">host:</span> <span class="hljs-string">https://fonts.loli.net</span><br><br>  <span class="hljs-comment"># Font options:</span><br>  <span class="hljs-comment"># `external: true` will load this font family from `host` above.</span><br>  <span class="hljs-comment"># `family: Times New Roman`. Without any quotes.</span><br>  <span class="hljs-comment"># `size: x.x`. Use `em` as unit. Default: 1 (16px)</span><br><br>  <span class="hljs-comment"># Global font settings used for all elements inside &lt;body&gt;.</span><br>  <span class="hljs-comment"># body元素的字体设置</span><br>  <span class="hljs-attr">global:</span><br>    <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">family:</span> <span class="hljs-string">LXGW</span> <span class="hljs-string">WenKai</span> <span class="hljs-string">Mono</span> <span class="hljs-string">TC</span><br>    <span class="hljs-attr">size:</span> <span class="hljs-number">1.04</span><br>  <br>  <span class="hljs-comment"># 左上角站点名称区的字体设置</span><br>  <span class="hljs-comment"># Font settings for site title (.site-title).</span><br>  <span class="hljs-attr">title:</span><br>    <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">family:</span> <br>    <span class="hljs-attr">size:</span> <br><br>  <span class="hljs-comment"># 标题的基础字体设置</span><br>  <span class="hljs-comment"># Font settings for headlines (&lt;h1&gt; to &lt;h6&gt;).</span><br>  <span class="hljs-attr">headings:</span><br>    <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">family:</span><br>    <span class="hljs-attr">size:</span><br><br>  <span class="hljs-comment"># 文章的字体设置</span><br>  <span class="hljs-comment"># Font settings for posts (.post-body).</span><br>  <span class="hljs-attr">posts:</span><br>    <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">family:</span> <br><br>  <span class="hljs-comment"># 代码块的字体设置</span><br>  <span class="hljs-comment"># Font settings for &lt;code&gt; and code blocks.</span><br>  <span class="hljs-attr">codes:</span><br>    <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">family:</span><br></code></pre></td></tr></table></figure>

<ol>
<li>将 <code>font</code> 下的 <code>enable</code> 由<strong>false</strong>改为<strong>true</strong>。  </li>
<li>添加你喜欢的 host ，个人推荐 <code>https://fonts.loli.net</code> ，当然不改也可以，但默认的谷歌字体在某些地区可能不太容易访问。  </li>
<li>修改 <code>family</code> 改变字体样式，修改 <code>size</code> 改变字体大小。</li>
</ol>
<h2><span id="修改文章标题样式">修改文章标题样式</span></h2><p>针对首页和文章页面中，对文章标题样式进行修改。<br>打开 <code>博客根目录\source\_data\styles.styl</code> 文件（没有的话就新建一个），在里面添加以下代码。  </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-comment">/* 首页标题样式 */</span><br><span class="hljs-selector-class">.index</span> <span class="hljs-selector-class">.post-title</span> <span class="hljs-selector-tag">a</span> &#123;<br>  <span class="hljs-attribute">color</span>: <span class="hljs-number">#3a5b52</span>; <span class="hljs-comment">/* 标题颜色 */</span><br>  <span class="hljs-attribute">position</span>: relative; <span class="hljs-comment">/* 确保伪元素相对于标题定位 */</span><br>  <span class="hljs-attribute">text-decoration</span>: none; <span class="hljs-comment">/* 去除默认的下划线 */</span><br>  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">25px</span>; <span class="hljs-comment">/* 标题字体大小 */</span><br>  <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">550</span>; <span class="hljs-comment">/* 字体粗细 */</span><br>  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">1.2</span>; <span class="hljs-comment">/* 行高 */</span><br>  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">5px</span>; <span class="hljs-comment">/* 标题下方的外边距 */</span><br>&#125;<br><br><span class="hljs-comment">/* 首页标题下划线样式 */</span><br><span class="hljs-selector-class">.index</span> <span class="hljs-selector-class">.post-title</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>  <span class="hljs-attribute">content</span>: <span class="hljs-string">&quot;&quot;</span>; <span class="hljs-comment">/* 伪元素需要有内容 */</span><br>  <span class="hljs-attribute">display</span>: block; <span class="hljs-comment">/* 伪元素需为块级元素以便展示 */</span><br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">2px</span>; <span class="hljs-comment">/* 横线的高度 */</span><br>  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#3a5b52</span>; <span class="hljs-comment">/* 横线颜色 */</span><br>  <span class="hljs-attribute">position</span>: absolute; <span class="hljs-comment">/* 定位伪元素 */</span><br>  <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">3px</span>; <span class="hljs-comment">/* 横线和标题之间的距离 */</span><br>  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* 初始宽度为 0 */</span><br>  <span class="hljs-attribute">transition</span>: width <span class="hljs-number">0.3s</span> ease; <span class="hljs-comment">/* 动画效果 */</span><br>&#125;<br><br><span class="hljs-comment">/* 首页标题悬停效果 */</span><br><span class="hljs-selector-class">.index</span> <span class="hljs-selector-class">.post-title</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span><span class="hljs-selector-pseudo">::after</span> &#123;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>; <span class="hljs-comment">/* 鼠标悬停时横线的宽度 */</span><br>&#125;<br><br><span class="hljs-comment">/* 确保其他可能影响横线的伪元素样式被移除 */</span><br><span class="hljs-selector-class">.index</span> <span class="hljs-selector-class">.post-title</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">::before</span> &#123;<br>  <span class="hljs-attribute">content</span>: none; <span class="hljs-comment">/* 确保没有黑色横线 */</span><br>&#125;<br><br><span class="hljs-comment">/* 文章页标题样式 */</span><br><span class="hljs-selector-class">.post</span> <span class="hljs-selector-class">.post-title</span> &#123;<br>  <span class="hljs-attribute">color</span>: <span class="hljs-number">#3a5b52</span> <span class="hljs-meta">!important</span>; <span class="hljs-comment">/* 强制应用颜色 */</span><br>  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">25px</span> <span class="hljs-meta">!important</span>; <span class="hljs-comment">/* 强制应用字体大小 */</span><br>  <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">550</span> <span class="hljs-meta">!important</span>; <span class="hljs-comment">/* 强制应用字体粗细 */</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>以上是该博客的文章标题样式，可按照个人需求，根据注释进行修改。  </p>
<h2><span id="给博客添加-top-文章置顶">给博客添加 top 文章置顶</span></h2><p>添加插件和使用方法请参考JWei Ma大神这篇教程：<a target="_blank" rel="noopener" href="https://zerobio.github.io/archives/5c4c93e2.html">Next 添加 top 文章置顶</a><br>而当我在设置置顶图标时，发现右侧会多出一条竖线，可能JWei Ma大神的教程不适用于 nexT 8.0 版本。<br>于是稍微改了一部分，并且把图标设置在左边，方法如下。<br>打开 <code>博客根目录\themes\next\layout\_partials\post\post-meta.njk</code> 文件，在第一行 <code>&lt;div class=&quot;post-meta&quot;&gt;</code> 下面，添加以下代码。  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html">&#123;% if post.top %&#125;<br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;padding-left: 8px;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;fa fa-thumbtack&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">font</span> <span class="hljs-attr">color</span>= <span class="hljs-string">对应颜色码</span> =<span class="hljs-string">&quot;font-weight: bold; padding-left: 4px;&quot;</span>&gt;</span> 置顶 <span class="hljs-tag">&lt;/<span class="hljs-name">font</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>&#123;% endif %&#125;<br></code></pre></td></tr></table></figure>

<p>这样就可以正常显示了。</p>

    </div>
</main>
        </div>
        <footer id="footer" style="margin-top: 10px;">
    <p>© 回到森林吧. 2021-2025</p>
</footer>
    </div>
</div>

<!-- 引入 highlight.js 库 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<!-- 引入代码块按钮功能 -->
<script src="/js/code-block-handler.js"></script>

<script>
// 修复meting-js在PJAX后的初始化问题
(function() {
    // 保存原始的自定义元素定义
    let originalMetingJS = null;
    
    // 等待meting.js加载
    function waitForMeting() {
        if (typeof window.customElements !== 'undefined' && window.customElements.get('meting-js')) {
            originalMetingJS = window.customElements.get('meting-js');
            console.log('Meting.js已加载');
        } else {
            setTimeout(waitForMeting, 100);
        }
    }
    
    // 强制重新初始化meting元素的函数
    window.forceMeting = function() {
        console.log('强制重新初始化meting元素');
        
        // 找到所有meting-js元素
        const metingElements = document.querySelectorAll('#pjax-container meting-js');
        
        metingElements.forEach(function(el, index) {
            setTimeout(function() {
                // 获取所有属性
                const attrs = {};
                Array.from(el.attributes).forEach(attr => {
                    attrs[attr.name] = attr.value;
                });
                
                // 创建新元素
                const newEl = document.createElement('meting-js');
                Object.keys(attrs).forEach(key => {
                    newEl.setAttribute(key, attrs[key]);
                });
                
                // 替换元素
                el.parentNode.replaceChild(newEl, el);
                
                console.log('Meting元素已替换:', newEl);
                
            }, index * 200); // 错开执行时间
        });
    };
    
    waitForMeting();
})();
</script>

<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script>

<!-- 全局播放器 -->
<div id="global-music-player">
    <meting-js
        id="4861729226"
        server="netease"
        type="playlist"
        fixed="true"
        autoplay="false"
        loop="all"
        order="random"
        preload="auto"
        list-folded="true"
        list-max-height="300px"
        lrc-type="1"
        theme="#cc543a"
        volume="0.55"
        mutex="true">
    </meting-js>
</div>

<script>
    // 全局变量
    window.pagePlayerInstances = [];
    window.globalPlayerInitialized = false;

    // PJAX初始化
    $(document).pjax('a:not([target="_blank"]):not([href^="#"]):not([no-pjax]):not([href^="mailto:"]):not([href^="tel:"])', '#pjax-container', {
        fragment: '#pjax-container',
        timeout: 8000
    });

    // PJAX开始时清理页面播放器
    $(document).on('pjax:start', function() {
        console.log('PJAX Start - Cleaning page players');
        cleanupPagePlayers();
    });

    // PJAX完成后重新初始化页面播放器和代码块
    $(document).on('pjax:complete', function() {
        console.log('PJAX Complete - Reinitializing page players and code blocks');
        initializePagePlayers();
        // 手动触发代码块初始化
        if (typeof initCodeBlocks !== 'undefined') {
            initCodeBlocks();
        } else {
            console.warn('initCodeBlocks not defined');
        }
    });

    // 页面首次加载初始化
    $(document).ready(function() {
        console.log('Document Ready - Initial setup');
        initGlobalPlayer();
        initializePagePlayers();
        // 确保初次加载时初始化代码块
        if (typeof initCodeBlocks !== 'undefined') {
            initCodeBlocks();
        } else {
            console.warn('initCodeBlocks not defined');
        }
    });

    // 清理页面播放器
    function cleanupPagePlayers() {
        window.pagePlayerInstances.forEach(player => {
            if (player && typeof player.destroy === 'function') {
                try {
                    player.destroy();
                } catch (e) {
                    console.warn('Error destroying player:', e);
                }
            }
        });
        window.pagePlayerInstances = [];

        document.querySelectorAll('#pjax-container .aplayer').forEach(el => {
            if (el.aplayer && typeof el.aplayer.destroy === 'function') {
                try {
                    el.aplayer.destroy();
                } catch (e) {
                    console.warn('Error destroying DOM player:', e);
                }
            }
            el.remove();
        });

        document.querySelectorAll('#pjax-container meting-js').forEach(el => {
            el.remove();
        });
    }

    // 初始化全局播放器
    function initGlobalPlayer() {
        if (window.globalPlayerInitialized) return;
        
        const globalPlayer = document.querySelector('#global-music-player meting-js');
        if (globalPlayer) {
            console.log('Global player found with mutex=true');
            window.globalPlayerInitialized = true;
            // 确保全局播放器只初始化一次
            forceMetingReload(globalPlayer);
        }
    }

    // 初始化页面播放器
    function initializePagePlayers() {
        console.log('Starting page player initialization');
        
        // 处理文章中的播放器容器
        const articlePlayers = document.querySelectorAll('#pjax-container .article-player meting-js:not([data-player-ready="true"])');
        console.log('Found article players:', articlePlayers.length);
        
        // 初始化未处理的播放器
        articlePlayers.forEach((metingElement, index) => {
            console.log(`Processing article player ${index + 1}`);
            metingElement.setAttribute('data-player-ready', 'true');
            metingElement.setAttribute('mutex', 'true');
            forceMetingReload(metingElement);
        });

        // 处理其他 meting-js 元素
        const otherMeting = document.querySelectorAll('#pjax-container meting-js:not(.article-player meting-js):not([data-player-ready="true"])');
        otherMeting.forEach((el, index) => {
            if (el.getAttribute('id') && el.getAttribute('server') && el.getAttribute('type')) {
                console.log(`Processing other meting element ${index + 1}`);
                el.setAttribute('data-player-ready', 'true');
                el.setAttribute('mutex', 'true');
                forceMetingReload(el);
            }
        });
    }

    // 重新加载 meting 元素
    function forceMetingReload(metingElement) {
        console.log('Reloading meting element');
        
        const parent = metingElement.parentNode;
        if (!parent) return;
        
        const newMeting = metingElement.cloneNode(true);
        newMeting.setAttribute('mutex', 'true');
        newMeting.setAttribute('data-reload-time', Date.now());
        
        parent.replaceChild(newMeting, metingElement);
        
        setTimeout(() => {
            checkPlayerLoadStatus(newMeting);
        }, 1000);
    }

    // 检查播放器加载状态
    function checkPlayerLoadStatus(metingElement) {
        const aplayer = metingElement.querySelector('.aplayer');
        
        if (!aplayer) {
            console.warn('Player failed to load');
            return;
        }
        
        console.log('Player loaded successfully');
        if (aplayer.aplayer) {
            window.pagePlayerInstances.push(aplayer.aplayer);
        }
    }

    // 调试函数
    function debugPlayerStatus() {
        console.log('=== Player Debug Info ===');
        console.log('Global player initialized:', window.globalPlayerInitialized);
        console.log('Page player instances:', window.pagePlayerInstances.length);
        console.log('Meting-js elements:', document.querySelectorAll('meting-js').length);
        
        document.querySelectorAll('meting-js').forEach((el, index) => {
            console.log(`Meting ${index + 1}:`, {
                id: el.getAttribute('id'),
                mutex: el.getAttribute('mutex'),
                hasAPlayer: !!el.querySelector('.aplayer')
            });
        });
        console.log('=========================');
    }

    window.debugPlayerStatus = debugPlayerStatus;
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>